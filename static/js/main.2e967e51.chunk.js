(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,n){e.exports=n(30)},22:function(e,t,n){},23:function(e,t,n){},26:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(13),i=n.n(r),c=n(32),s=n(33),l=(n(22),n(4)),u=n(6),h=n(8),m=n(7),d=n(9),f=(n(23),n(14)),p=n(11),g=n.n(p),v=function e(t){var n=this;Object(l.a)(this,e),this.login=function(e,t){return n.fetch("".concat(n.domain,"/api/auth/token/obtain/"),{method:"POST",mode:"no-cors",body:JSON.stringify({username:e,password:t})}).then(function(e){return console.log(e),n.setToken(e.access),Promise.resolve(e)})},this.loggedIn=function(){var e=n.getToken();return!!e&&!n.isTokenExpired(e)},this.isTokenExpired=function(e){try{return g()(e).exp<Date.now()/1e3}catch(t){return console.log(t,"expired check failed! Line 42: AuthService.js"),!1}},this.setToken=function(e){localStorage.setItem("id_token",e)},this.getToken=function(){return localStorage.getItem("id_token")},this.logout=function(){localStorage.removeItem("id_token")},this.getConfirm=function(){var e=g()(n.getToken());return console.log("Recieved answer!"),e},this.fetch=function(e,t){console.log(e,t);var o={"Content-Type":"application/json"};return n.loggedIn()&&(o.Authorization="Bearer "+n.getToken()),fetch(e,Object(f.a)({headers:o},t)).then(function(e){return e.json()})},this._checkStatus=function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t},this.domain=t||"https://pathrocle.pythonanywhere.com"};var w=function(e){var t=new v;return function(n){function o(){var e,t;Object(l.a)(this,o);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=Object(h.a)(this,(e=Object(m.a)(o)).call.apply(e,[this].concat(a)))).state={confirm:null,loaded:!1},t}return Object(d.a)(o,n),Object(u.a)(o,[{key:"componentDidMount",value:function(){if(t.loggedIn())try{var e=t.getConfirm();console.log("confirmation is:",e),this.setState({confirm:e,loaded:!0})}catch(n){console.log(n),t.logout(),this.props.history.replace("/login")}else this.props.history.replace("/login")}},{key:"render",value:function(){return 1==this.state.loaded?this.state.confirm?(console.log("confirmed!"),a.a.createElement(e,{history:this.props.history,confirm:this.state.confirm})):(console.log("not confirmed!"),null):null}}]),o}(o.Component)}(function(e){function t(){var e,n;Object(l.a)(this,t);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).Auth=new v,n.state={username:"",password:""},n._handleLogout=function(){n.Auth.logout(),n.props.history.replace("/login")},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=null;return this.props.confirm&&(e=this.props.confirm.username),a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"main-page"},a.a.createElement("div",{className:"top-section"},a.a.createElement("h1",null,"Welcome, ",e)),a.a.createElement("div",{className:"bottom-section"},a.a.createElement("button",{onClick:this._handleLogout},"LOGOUT"))))}}]),t}(o.Component)),b=n(10),y=(n(26),function(e){function t(){var e,n;Object(l.a)(this,t);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(n=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).Auth=new v,n.state={username:"",password:""},n._handleChange=function(e){n.setState(Object(b.a)({},e.target.name,e.target.value))},n.handleFormSubmit=function(e){e.preventDefault(),n.Auth.login(n.state.username,n.state.password).then(function(e){if(console.log(e),!1===e)return alert("Sorry those credentials don't exist!");n.props.history.replace("/")}).catch(function(e){alert(e)})},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.Auth.loggedIn()&&this.props.history.replace("/")}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"main-wrapper"},a.a.createElement("div",{className:"box"},a.a.createElement("div",{className:"box-header"},a.a.createElement("h1",null,"po/co")),a.a.createElement("form",{className:"box-form"},a.a.createElement("input",{className:"form-item",placeholder:"Username",name:"username",type:"text",onChange:this._handleChange}),a.a.createElement("input",{className:"form-item",placeholder:"Password",name:"password",type:"password",onChange:this._handleChange}),a.a.createElement("button",{className:"form-submit",onClick:this.handleFormSubmit},"Login")))))}}]),t}(o.Component)),k=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(a.a.createElement(c.a,null,a.a.createElement("div",null,a.a.createElement(s.a,{exact:!0,path:"/",component:w}),a.a.createElement(s.a,{exact:!0,path:"/login",component:y}))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");k?(function(e,t){fetch(e).then(function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):E(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):E(t,e)})}}()}},[[16,1,2]]]);
//# sourceMappingURL=main.2e967e51.chunk.js.map